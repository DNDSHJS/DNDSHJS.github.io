<!DOCTYPE html>
<html>
<head>
    <title>D&D 伤害计算器</title>
</head>
<body>
    <h2>D&D 伤害期望计算器</h2>
    <p>输入骰子公式如：4d10+2d6。若要加入易伤与抗性则在后面加入v,r。如4d10v+2d6r（'v'表示易伤，'r'表示抗性）:</p>
    <input type="text" id="diceExpression" placeholder="4d10v+2d6r">
    <button onclick="calculateDamage()">Calculate</button>
    <p id="result"></p>

    <script>
        function calculateDamage() {
            var expression = document.getElementById('diceExpression').value;
            var parts = expression.split('+');
            var totalExpectation = 0;
            for (var i = 0; i < parts.length; i++) {
                var part = parts[i];
                var modifier = 1; // 默认没有易伤或抗性
                if (part.endsWith('v')) {
                    modifier = 2; // 易伤，伤害加倍
                    part = part.slice(0, -1); // 移除最后一个字符
                } else if (part.endsWith('r')) {
                    modifier = 0.5; // 抗性，伤害减半
                    part = part.slice(0, -1); // 移除最后一个字符
                }
                
                var [numDice, diceSides] = part.split('d').map(Number);
                var expectation = numDice * (diceSides + 1) / 2 * modifier;
                totalExpectation += expectation;
            }
            document.getElementById('result').innerHTML = "Expected Damage: " + totalExpectation;
        }
    </script>
</body>
</html>



#自动侏儒会跑ai团吗？出品。有任何问题概不负责（确信）
